!function(){class e extends HTMLElement{static observedAttributes=["add-item-text"];static #a="This value already exists!";constructor(){super()}#b(){let t=this.attachShadow({mode:"open"}),i=document.createElement("div"),s=this.getAttribute("add-item-text")||"",l=this.#c();i.classList.add("editable-list","defocused"),i.innerHTML=`<style>:host(.disabled){pointer-events:none}.editable-list{background:#fff;border:1px solid #444;border-radius:4px;padding:12px;min-width:300px}.editable-list.defocused{border:1px solid silver}ul{padding:0;margin:0}li{height:36px;padding:0 8px;cursor:default}.editable-list:not(.defocused) li.selected{background:#f8f8f8}div>div,li{display:flex;align-items:center;justify-content:space-between}.editable-list:not(.defocused) li:hover{background:#eee}.item-wrapper{display:flex;padding-right:8px;padding-left:2px;align-items:baseline}.toolbar{display:flex;gap:6px}.editable-list.defocused .toolbar,li:not(.selected) .toolbar{opacity:0;pointer-events:none}.toolbar button{position:relative}.toolbar button:hover:before{content:' ';position:absolute;width:24px;height:24px;background:rgba(0,0,0,.1);left:-4px;top:-4px;border-radius:50%}.icon{background-color:transparent;border:none;cursor:pointer;font-size:0;fill:#444;padding:0}.icon svg{width:16px;height:16px}.new-list-item{margin-top:16px;padding:0 8px 0 2px}.add-new-list-item-input,.edit-list-item-input{padding:6px 8px;border-radius:4px;border:1px solid #bbb;font-size:14px;font-family:inherit}.editable-list.defocused .add-new-list-item-input{border:1px solid transparent;opacity:.5}.edit-list-item-input{margin-left:-8px}</style><ul class="item-list">${l.map(e=>`<li>${this.#d(e)}</li>`).join("")}</ul><div class="new-list-item"><input class="add-new-list-item-input" type="text" placeholder="${s}"><div class="toolbar"><button class="editable-list-add-item icon" title="Add"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg></button></div></div>`,t.appendChild(i)}#e(n){return new CustomEvent("change",{bubbles:!0,cancelable:!1,composed:!0,detail:n})}#f(r){r.composedPath().includes(this)||this.shadowRoot.querySelector(".editable-list").classList.add("defocused")}#g(o){this.shadowRoot.querySelector(".editable-list").classList.remove("defocused")}#h(d){if(d instanceof KeyboardEvent&&"Enter"===d.key||!(d instanceof KeyboardEvent)){let a=this.shadowRoot.querySelector(".add-new-list-item-input");if(""!==a.value.trim()){let h="false"!==this.getAttribute("allow-duplicates"),c=this.getAttribute("duplicate-prompt")||e.#a;if(!h&&this.#i(a.value,null)){""!==c.trim()&&alert(c),a.focus();return}this.addItems([a.value]),this.dispatchEvent(this.#e({action:"add",previous:null,new:a.value})),this.#j().lastChild.click(),a.value=""}}}connectedCallback(){this.#b();let e=this.shadowRoot.querySelector(".editable-list"),t=[...this.shadowRoot.querySelectorAll("li")],i=[...this.shadowRoot.querySelectorAll(".item-wrapper")],s={};s.up=[...this.shadowRoot.querySelectorAll(".editable-list-up-item")],s.down=[...this.shadowRoot.querySelectorAll(".editable-list-down-item")],s.remove=[...this.shadowRoot.querySelectorAll(".editable-list-remove-item")];let l=this.shadowRoot.querySelector(".new-list-item"),n=this.shadowRoot.querySelector(".add-new-list-item-input"),r=this.shadowRoot.querySelector(".editable-list-add-item");this.#k(),document.addEventListener("click",this.#f.bind(this),!1),e.addEventListener("click",this.#g.bind(this),!0),this.#l.bind(this)(t),this.#m.bind(this)(i,s),l.addEventListener("click",this.#n.bind(this),!0),n.addEventListener("keypress",this.#h.bind(this),!1),r.addEventListener("click",this.#h.bind(this),!1)}attributeChangedCallback(e,t,i){this.shadowRoot&&"add-item-text"===e&&this.shadowRoot.querySelector(".add-new-list-item-input").setAttribute("placeholder",i)}#c(){let p=[];return[...this.attributes].forEach(e=>{e.name.includes("list-item")&&p.push(e.value)}),p}#d(u){return`<div class="item-wrapper">${u}</div><div class="toolbar"><button class="editable-list-up-item icon" title="Move up"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><path d="m5 9 1.41 1.41L11 5.83V22h2V5.83l4.59 4.59L19 9l-7-7-7 7z"></path></svg></button><button class="editable-list-down-item icon" title="Move down"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><path d="m19 15-1.41-1.41L13 18.17V2h-2v16.17l-4.59-4.59L5 15l7 7 7-7z"></path></svg></button><button class="editable-list-remove-item icon" title="Remove"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg></button></div>`}#k(){let m=this.shadowRoot.querySelectorAll(".editable-list-up-item"),v=this.shadowRoot.querySelectorAll(".editable-list-down-item"),b=m.length;for(let w=0;w<b;w++)m[w].style.visibility=0==w?"hidden":"visible",v[w].style.visibility=w==b-1?"hidden":"visible"}#l(g){g.forEach(e=>{e.addEventListener("click",this.#o.bind(this),!1)})}#m(f,_){let x=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);f.forEach(e=>{e.addEventListener("dblclick",this.#p.bind(this),!1),x&&e.addEventListener("touchend",this.#q())}),_.up.forEach(e=>{e.addEventListener("click",this.#r.bind(this),!1)}),_.down.forEach(e=>{e.addEventListener("click",this.#s.bind(this),!1)}),_.remove.forEach(e=>{e.addEventListener("click",this.#t.bind(this),!1)})}#p(L){if(this._editing)return;this._editing=!0;let $=this.#u(L.target),y=$.querySelector(".item-wrapper"),E=document.createElement("INPUT");E.className="edit-list-item-input",E.value=y.innerText,E._value=y.innerText,E.addEventListener("blur",this.#v.bind(this),!1),E.addEventListener("keypress",this.#v.bind(this),!1),y.innerHTML="",y.appendChild(E),E.focus()}#v(S){if(this._editing&&(S instanceof KeyboardEvent&&"Enter"===S.key||!(S instanceof KeyboardEvent))){S.preventDefault();let k=this.#u(S.target);k.querySelector(".item-wrapper");let q=k.querySelector(".item-wrapper input"),I=q._value,A=this.#w(k,q.value,I),T=this.getAttribute("duplicate-prompt")||e.#a;A.accepted||""===T.trim()||alert(T),A.differs&&this.dispatchEvent(this.#e({action:"edit",previous:I,new:A.val}))}}#q(){let H=0,R,M=function(e){let t=new Date().getTime(),i=t-H;i<500&&i>0?(e.preventDefault(),this.#p(e)):R=setTimeout(()=>{clearTimeout(R)},500),H=t};return M.bind(this)}#w(P,D,B){let z={val:"",accepted:!0,differs:!1},C=P.querySelector(".item-wrapper"),N=D;""===N.trim()&&(N=B);let V="false"!==this.getAttribute("allow-duplicates");return!V&&this.#i(N,C)&&(N=B,z.accepted=!1),this._editing=!1,C.innerHTML=N,z.val=N,z.differs=N!==B,z}#o(U){this.#n.bind(this)();let F=this.#u(U.target);F.classList.toggle("selected",!0)}#t(j){j.stopPropagation();let O=this.#u(j.target),G=this.#x(O.querySelector(".item-wrapper").innerHTML);this.#y(O),this.dispatchEvent(this.#e({action:"remove",previous:G,new:null}))}#r(J){J.stopPropagation();let K=this.#u(J.target);if(!this.#z(K))return;let Q=this.#x(K.querySelector(".item-wrapper").innerHTML);this.dispatchEvent(this.#e({action:"move",direction:"up",item:Q}))}#s(W){W.stopPropagation();let X=this.#u(W.target);if(!this.#A(X))return;let Y=this.#x(X.querySelector(".item-wrapper").innerHTML);this.dispatchEvent(this.#e({action:"move",direction:"down",item:Y}))}#n(Z){[...this.shadowRoot.querySelectorAll("li")].forEach(e=>{e.classList.toggle("selected",!1)})}#z(ee){let et=ee.previousElementSibling;return!!et&&(ee.parentNode.insertBefore(ee,et),this.#k(),!0)}#A(ei){let es=ei.nextElementSibling;return!!es&&(ei.parentNode.insertBefore(es,ei),this.#k(),!0)}#y(el){el.remove(),this.#k()}#j(){return this.shadowRoot.querySelector(".item-list")}#u(en){for(;"LI"!==en.tagName;)en=en.parentNode;return en}#B(er){return this.#j().children[er]||null}#i(eo,ed){let ea=[...this.shadowRoot.querySelectorAll("li .item-wrapper")],eh=!1;for(var ec=0;ec<ea.length;ec++)if(ea[ec]!==ed&&ea[ec].innerText===eo){eh=!0;break}return eh}#x(ep){var eu=document.createElement("textarea");return eu.innerHTML=ep,eu.value}items(){return[...this.shadowRoot.querySelectorAll(".item-wrapper")].map(e=>this.#x(e.innerHTML))}addItems(e){let t=[],i=[],s={up:[],down:[],remove:[]},l="false"!==this.getAttribute("allow-duplicates");e.forEach(e=>{if(l||!this.#i(e,null)){let n=document.createElement("li");n.innerHTML=this.#d(e),this.#j().appendChild(n),t.push(n),i.push(n.querySelector(".item-wrapper")),s.up.push(n.querySelector(".editable-list-up-item")),s.down.push(n.querySelector(".editable-list-down-item")),s.remove.push(n.querySelector(".editable-list-remove-item"))}}),this.#l.bind(this)(t),this.#m.bind(this)(i,s),this.#k()}changeItem(e,t){let i=this.#B(e);if(null===i||this._editing)return;this._editing=!0;let s=i.querySelector(".item-wrapper");this.#w(i,t,s.innerText)}removeItem(e){let t=this.#B(e);null!==t&&this.#y(t)}moveItemUp(e){let t=this.#B(e);null!==t&&this.#z(t)}moveItemDown(e){let t=this.#B(e);null!==t&&this.#A(t)}removeAllItems(){this.#j().innerHTML=""}unselectAllItems(){this.#n()}}customElements.define("editable-list",e)}();